void uremdiv(unsigned long x, unsigned long y,
             unsigned long *qp,unsigned long *rp) {
    unsigned long q = x/y;
    unsigned long r = x%y;
    *qp = q;
    *rp = r;
}

# void uremdiv(unsigned long x, unsigned long y,
#              unsigned long *qp,unsigned long *rp)
# x in %rdi, y in %rsi, qp in %rdx, rp in %rcx
uremdiv:
    movq %rdx, %r8    # Copy qp
    movq %rdi, %rax   # Move x to lower 8 bytes of dividend
    movq $0, %rdx     # Clear upper 8 bytes of dividend
    divq %rsi         # Divide by y
    movq %rax, (%r8)  # Store quotient at qp
    movq %rdx, (%rcx) # Store remainder at rp
    ret
